{% extends 'base.html' %}
{% load static %}
{% block content %} 
    <title>{% block title %}Programs List{% endblock %}</title>

    <div class="container" style="margin: 40px;">
        <div class="text-center p-5 rounded shadow-lg position-relative">
            <!-- Back Button -->
            <a href="javascript:history.back()" class="btn btn-outline-primary position-absolute" style="top: 20px; right: 20px;">
                ← Back
            </a>

            <!-- Main Page Caption -->
            <div class="kingster-page-caption fw-bold text-uppercase text-primary mb-3" style="letter-spacing: 2px;">
                Latest Program at LITSU
            </div>

            <!-- Page Title -->
            <h4 class="fw-bold display-6 mb-3">
                Programs
            </h4>
        </div>
    </div>


    <div class="kingster-page-wrapper" id="kingster-page-wrapper">
        <div class="gdlr-core-page-builder-body clearfix">
            <div class="gdlr-core-pbf-section">
                <div class="gdlr-core-pbf-section-container gdlr-core-container clearfix">
                    <div class="gdlr-core-pbf-element">
                        <div class="gdlr-core-blog-item gdlr-core-item-pdb clearfix  gdlr-core-style-blog-column gdlr-core-left-align" style="padding-bottom: 40px ;">
                            
                            <div class="gdlr-core-blog-item-holder gdlr-core-js-2 clearfix" data-layout="fitrows">
                                <!-- Articles Container -->
                                <div id="articles-container">
                                    {% for i in programs_list %}
                                    <div class="gdlr-core-item-list gdlr-core-item-pdlr gdlr-core-column-15">
                                        <div class="gdlr-core-blog-grid ">
                                            <div class="gdlr-core-blog-thumbnail gdlr-core-media-image gdlr-core-opacity-on-hover gdlr-core-zoom-on-hover" style="width: 100%; height: 200px; overflow: hidden; border-radius: 10px;">
                                                <a href="{% url 'programs_detail' i.id %}">
                                                    <img src="{{ i.image.url }}" alt="" style="width: 100%; height: 100%; object-fit: cover;" />
                                                </a>
                                            </div>

                                            <div class="gdlr-core-blog-grid-content-wrap">
                                                <div class="gdlr-core-blog-info-wrapper gdlr-core-skin-divider">
                                                    <span class="gdlr-core-blog-info gdlr-core-blog-info-font gdlr-core-skin-caption gdlr-core-blog-info-date">
                                                        <a href="{% url 'programs_detail' i.id %}">
                                                            {{ i.created_at }}
                                                        </a>
                                                    </span>
                                                </div>
                                                <h3 class="gdlr-core-blog-title gdlr-core-skin-title" style="font-size: 13px; font-weight: 700; letter-spacing: 0px;">
                                                    <a href="{% url 'programs_detail' i.id %}">
                                                        {{ i.title }}
                                                    </a>
                                                </h3>
                                                <div class="gdlr-core-blog-content clearfix">
                                                    {{ i.content|truncatewords:6 }}
                                                    <div class="clear"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                            
                            <div class="gdlr-core-pagination gdlr-core-style-circle gdlr-core-left-align gdlr-core-item-pdlr">
                                <ul class="pagination" id="pagination-controls"></ul>
                            </div>

                            <script>
                                document.addEventListener("DOMContentLoaded", function () {
                                    const articlesContainer = document.getElementById("articles-container");
                                    const paginationControls = document.getElementById("pagination-controls");

                                    const articles = Array.from(articlesContainer.children);
                                    const articlesPerPage = 40; // Number of articles per page
                                    let currentPage = 1;

                                    // Function to show only the articles for the current page
                                    function showPage(page) {
                                        const start = (page - 1) * articlesPerPage;
                                        const end = start + articlesPerPage;

                                        articles.forEach((article, index) => {
                                            article.style.display = (index >= start && index < end) ? '' : 'none';
                                        });

                                        updatePagination();
                                    }

                                    // Function to update pagination controls (GoodLayers style)
                                    function updatePagination() {
                                        paginationControls.innerHTML = ''; // Clear pagination controls

                                        const totalPages = Math.ceil(articles.length / articlesPerPage);

                                        // Previous button
                                        if (currentPage > 1) {
                                            const prev = document.createElement("a");
                                            prev.className = "prev page-numbers";
                                            prev.href = "#";
                                            prev.textContent = "‹";
                                            prev.onclick = (e) => {
                                                e.preventDefault();
                                                currentPage--;
                                                showPage(currentPage);
                                            };
                                            paginationControls.appendChild(prev);
                                        }

                                        // Page number buttons
                                        for (let i = 1; i <= totalPages; i++) {
                                            if (i === currentPage) {
                                                const span = document.createElement("span");
                                                span.className = "page-numbers current";
                                                span.textContent = i;
                                                paginationControls.appendChild(span);
                                            } else {
                                                const link = document.createElement("a");
                                                link.className = "page-numbers";
                                                link.href = "#";
                                                link.textContent = i;
                                                link.onclick = (e) => {
                                                    e.preventDefault();
                                                    currentPage = i;
                                                    showPage(currentPage);
                                                };
                                                paginationControls.appendChild(link);
                                            }
                                        }

                                        // Next button
                                        if (currentPage < totalPages) {
                                            const next = document.createElement("a");
                                            next.className = "next page-numbers";
                                            next.href = "#";
                                            next.textContent = "›";
                                            next.onclick = (e) => {
                                                e.preventDefault();
                                                currentPage++;
                                                showPage(currentPage);
                                            };
                                            paginationControls.appendChild(next);
                                        }
                                    }

                                    // Show the first page initially
                                    showPage(currentPage);
                                });

                            </script>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

{% endblock content %}